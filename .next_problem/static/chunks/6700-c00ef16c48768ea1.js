(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6700],{3507:function(e,t,s){Promise.resolve().then(s.t.bind(s,2972,23)),Promise.resolve().then(s.bind(s,3547))},3639:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},5252:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},3113:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},3229:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},2720:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]])},7689:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},2489:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},3547:function(e,t,s){"use strict";s.d(t,{ProductForm:function(){return v}});var r=s(7437),a=s(2265),l=s(9376),i=s(2381),n=s(279),d=s(3675),o=s(5060),c=s(5291),u=s(9174),m=s(4357),x=s(2720),h=s(5252),p=s(3113),g=s(2489),f=s(7689),b=s(3229),y=s(8933),j=s(9064);function v(e){var t;let{vendorId:s,product:v,isEditing:N=!1}=e,w=(0,l.useRouter)(),[k,C]=(0,a.useState)(!1),[P,Z]=(0,a.useState)(!1),[S,_]=(0,a.useState)({}),[U,z]=(0,a.useState)(new Set),[I,q]=(0,a.useState)([]),[E,F]=(0,a.useState)({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),[M,D]=(0,a.useState)({name:(null==v?void 0:v.name)||"",description:(null==v?void 0:v.description)||"",price:(null==v?void 0:null===(t=v.price)||void 0===t?void 0:t.toString())||"",sku:(null==v?void 0:v.sku)||"",status:(null==v?void 0:v.status)||"draft",category_id:(null==v?void 0:v.category_id)||"none"}),[O,L]=(0,a.useState)([]),[H,R]=(0,a.useState)((null==v?void 0:v.product_images)||[]);(0,a.useEffect)(()=>{(async()=>{try{let e=(0,y.e)(),{data:t,error:r}=await e.from("categories").select("id, name").eq("vendor_id",s).eq("is_active",!0).order("name");if(r)throw r;q(t||[])}catch(e){console.error("Error loading categories:",e)}})()},[s]);let T=async e=>{e.preventDefault(),C(!0);try{let e;let t=(0,y.e)(),r={vendor_id:s,name:M.name,description:M.description||null,price:M.price?parseFloat(M.price):null,sku:M.sku||null,status:M.status,category_id:M.category_id&&"none"!==M.category_id?M.category_id:null};if(N&&v){let{data:s,error:a}=await t.from("products").update(r).eq("id",v.id).select().single();if(a)throw a;e=s.id}else{let{data:s,error:a}=await t.from("products").insert(r).select().single();if(a)throw a;e=s.id}O.length>0&&await B(e),j.ZP.success(N?"Product updated successfully!":"Product created successfully!"),w.push("/dashboard/products"),w.refresh()}catch(e){console.error("Error saving product:",e),j.ZP.error("Error saving product. Please try again.")}finally{C(!1)}},B=async e=>{Z(!0);try{for(let t=0;t<O.length;t++){let s=O[t],r="".concat(s.name,"-").concat(s.size,"-").concat(s.lastModified);_(e=>({...e,[r]:0}));let a=new FormData;a.append("file",s),a.append("productId",e),a.append("displayOrder",(H.length+t).toString());let l=await fetch("/api/upload",{method:"POST",body:a});if(!l.ok){let e=await l.json();throw Error(e.error||"Failed to upload image")}let i=await l.json();_(e=>({...e,[r]:100})),console.log("Image uploaded successfully:",i)}}finally{Z(!1),_({})}},A=e=>{L(O.filter((t,s)=>s!==e))};return(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-8 mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-primary text-primary-foreground font-semibold text-sm",children:"1"}),(0,r.jsx)("span",{className:"text-body-sm font-medium text-foreground",children:"Basic Info"})]}),(0,r.jsx)("div",{className:"h-px bg-border flex-1 max-w-16"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-primary text-primary-foreground font-semibold text-sm",children:"2"}),(0,r.jsx)("span",{className:"text-body-sm font-medium text-foreground",children:"Images"})]})]}),(0,r.jsxs)("form",{onSubmit:T,className:"space-y-8",children:[(0,r.jsxs)("div",{className:"bg-card border border-border rounded-xl p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-chart-1/10 text-chart-1",children:(0,r.jsx)(x.Z,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-heading-lg font-semibold text-foreground",children:"Basic Information"}),(0,r.jsx)("p",{className:"text-body-sm text-muted-foreground",children:"Essential details about your product"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o._,{htmlFor:"name",className:"text-label-lg font-medium text-foreground",children:"Product Name *"}),(0,r.jsx)(n.I,{id:"name",value:M.name,onChange:e=>D(t=>({...t,name:e.target.value})),placeholder:"Enter a descriptive product name",required:!0,maxLength:255,className:"h-11"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o._,{htmlFor:"sku",className:"text-label-lg font-medium text-foreground",children:"SKU (Stock Keeping Unit)"}),(0,r.jsx)(n.I,{id:"sku",value:M.sku,onChange:e=>D(t=>({...t,sku:e.target.value})),placeholder:"e.g. PROD-001",maxLength:100,className:"h-11"}),(0,r.jsx)("p",{className:"text-label-sm text-muted-foreground",children:"Optional unique identifier for inventory tracking"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o._,{htmlFor:"description",className:"text-label-lg font-medium text-foreground",children:"Product Description"}),(0,r.jsx)(d.g,{id:"description",value:M.description,onChange:e=>D(t=>({...t,description:e.target.value})),placeholder:"Provide a detailed description of your product, including features, benefits, and specifications...",rows:5,maxLength:1e3,className:"resize-none"}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("p",{className:"text-label-sm text-muted-foreground",children:"Help customers understand what makes your product special"}),(0,r.jsxs)("span",{className:"text-label-sm text-muted-foreground",children:[M.description.length,"/1000"]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o._,{htmlFor:"price",className:"text-label-lg font-medium text-foreground",children:"Price"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(h.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(n.I,{id:"price",type:"number",step:"0.01",min:"0",value:M.price,onChange:e=>D(t=>({...t,price:e.target.value})),placeholder:"0.00",className:"pl-10 h-11"})]}),(0,r.jsx)("p",{className:"text-label-sm text-muted-foreground",children:"Leave empty if price varies or on request"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o._,{htmlFor:"category",className:"text-label-lg font-medium text-foreground",children:"Category"}),(0,r.jsxs)(c.Ph,{value:M.category_id,onValueChange:e=>D(t=>({...t,category_id:e})),children:[(0,r.jsx)(c.i4,{className:"h-11",children:(0,r.jsx)(c.ki,{placeholder:"Choose a category"})}),(0,r.jsxs)(c.Bw,{children:[(0,r.jsx)(c.Ql,{value:"none",children:"No Category"}),I.map(e=>(0,r.jsx)(c.Ql,{value:e.id,children:e.name},e.id))]})]}),(0,r.jsx)("p",{className:"text-label-sm text-muted-foreground",children:"Helps organize your catalog"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o._,{htmlFor:"status",className:"text-label-lg font-medium text-foreground",children:"Visibility Status"}),(0,r.jsxs)(c.Ph,{value:M.status,onValueChange:e=>D(t=>({...t,status:e})),children:[(0,r.jsx)(c.i4,{className:"h-11",children:(0,r.jsx)(c.ki,{placeholder:"Select status"})}),(0,r.jsxs)(c.Bw,{children:[(0,r.jsx)(c.Ql,{value:"draft",children:"Draft (Hidden)"}),(0,r.jsx)(c.Ql,{value:"active",children:"Active (Visible)"}),(0,r.jsx)(c.Ql,{value:"inactive",children:"Inactive (Hidden)"})]})]}),(0,r.jsx)("p",{className:"text-label-sm text-muted-foreground",children:"Controls public visibility"})]})]})]}),(0,r.jsxs)("div",{className:"bg-card border border-border rounded-xl p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-chart-2/10 text-chart-2",children:(0,r.jsx)(p.Z,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-heading-lg font-semibold text-foreground",children:"Product Images"}),(0,r.jsx)("p",{className:"text-body-sm text-muted-foreground",children:"Upload high-quality images to showcase your product"})]}),(0,r.jsx)("div",{className:"ml-auto",children:(0,r.jsxs)(u.C,{variant:"outline",className:"text-label-sm",children:[O.length+H.length,"/10"]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4",children:[H.map((e,t)=>{let s=U.has(e.id);return(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsxs)("div",{className:"aspect-square bg-muted/20 rounded-xl overflow-hidden border border-border hover:border-primary/50 transition-colors",children:[(0,r.jsx)("img",{src:e.url,alt:e.alt_text,className:"w-full h-full object-cover"}),s&&(0,r.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-white text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-white border-t-transparent mx-auto mb-2"}),(0,r.jsx)("div",{className:"text-label-sm",children:"Deleting..."})]})})]}),(0,r.jsx)("button",{type:"button",className:"absolute top-2 right-2 bg-destructive hover:bg-destructive/90 text-destructive-foreground rounded-lg p-1.5 opacity-0 group-hover:opacity-100 transition-all duration-200 shadow-lg",disabled:s,onClick:()=>{F({isOpen:!0,title:"Delete Image",message:"Are you sure you want to delete this image? This action cannot be undone.",onConfirm:async()=>{if(F(e=>({...e,isOpen:!1})),e.id){z(t=>new Set(t).add(e.id));try{let s=await fetch("/api/upload/".concat(e.id),{method:"DELETE"});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to delete image")}R(H.filter((e,s)=>s!==t)),j.ZP.success("Image deleted successfully")}catch(e){console.error("Error deleting image:",e),j.ZP.error("Failed to delete image: ".concat((null==e?void 0:e.message)||"Unknown error"))}finally{z(t=>{let s=new Set(t);return s.delete(e.id),s})}}}})},children:(0,r.jsx)(g.Z,{className:"h-3 w-3"})}),0===t&&(0,r.jsx)(u.C,{className:"absolute bottom-2 left-2 text-xs bg-primary text-primary-foreground",children:"Primary"})]},"existing-".concat(t))}),O.map((e,t)=>{let s=S["".concat(e.name,"-").concat(e.size,"-").concat(e.lastModified)],a=P&&void 0!==s;return(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsxs)("div",{className:"aspect-square bg-muted/20 rounded-xl overflow-hidden border-2 border-dashed border-chart-2/30",children:[(0,r.jsx)("img",{src:URL.createObjectURL(e),alt:e.name,className:"w-full h-full object-cover"}),a&&(0,r.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-white text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-white border-t-transparent mx-auto mb-2"}),(0,r.jsx)("div",{className:"text-label-sm",children:100===s?"Complete!":"Uploading..."})]})})]}),(0,r.jsx)("button",{type:"button",className:"absolute top-2 right-2 bg-destructive hover:bg-destructive/90 text-destructive-foreground rounded-lg p-1.5 opacity-0 group-hover:opacity-100 transition-all duration-200 shadow-lg",onClick:()=>A(t),disabled:a,children:(0,r.jsx)(g.Z,{className:"h-3 w-3"})}),0===t&&0===H.length&&(0,r.jsx)(u.C,{className:"absolute bottom-2 left-2 text-xs bg-primary text-primary-foreground",children:"Primary"})]},"new-".concat(t))}),O.length+H.length<10&&(0,r.jsxs)("label",{className:"aspect-square border-2 border-dashed border-border hover:border-primary/50 rounded-xl flex flex-col items-center justify-center cursor-pointer transition-all duration-200 hover:bg-primary/5 group",children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10 text-primary group-hover:bg-primary/20 transition-colors mb-3",children:(0,r.jsx)(f.Z,{className:"h-6 w-6"})}),(0,r.jsx)("span",{className:"text-body-sm font-medium text-foreground mb-1",children:"Upload Images"}),(0,r.jsx)("span",{className:"text-label-sm text-muted-foreground",children:"JPG, PNG up to 10MB"}),(0,r.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>{L([...O,...Array.from(e.target.files||[])])},className:"hidden"})]})]}),(0,r.jsx)("div",{className:"bg-muted/30 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-info/20 text-info mt-0.5",children:(0,r.jsx)(p.Z,{className:"h-3 w-3"})}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("p",{className:"text-body-sm font-medium text-foreground",children:"Image Guidelines"}),(0,r.jsxs)("ul",{className:"text-label-sm text-muted-foreground space-y-0.5",children:[(0,r.jsx)("li",{children:"• Upload up to 10 high-quality images"}),(0,r.jsx)("li",{children:"• First image becomes the primary thumbnail"}),(0,r.jsx)("li",{children:"• Recommended size: 1200x1200 pixels"}),(0,r.jsx)("li",{children:"• Supported formats: JPG, PNG (max 10MB each)"})]})]})]})})]}),(0,r.jsxs)("div",{className:"bg-card border border-border rounded-xl p-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-4",children:[(0,r.jsx)(i.z,{type:"button",variant:"outline",size:"lg",onClick:()=>w.back(),disabled:k,className:"order-2 sm:order-1",children:"Cancel"}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 order-1 sm:order-2",children:[!N&&(0,r.jsx)(i.z,{type:"button",variant:"outline",size:"lg",onClick:()=>D(e=>({...e,status:"draft"})),disabled:k,children:"Save as Draft"}),(0,r.jsx)(i.z,{type:"submit",size:"lg",variant:"gradient",disabled:k||P||!M.name.trim(),className:"min-w-[140px]",children:k||P?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),P?"Uploading...":N?"Updating...":"Creating..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.Z,{className:"h-4 w-4 mr-2"}),N?"Update Product":"Create Product"]})})]})]}),(k||P)&&(0,r.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-label-sm text-muted-foreground",children:[(0,r.jsx)("span",{children:P?"Uploading images...":N?"Updating product...":"Creating product..."}),(0,r.jsx)("span",{children:"Please wait"})]}),(0,r.jsx)("div",{className:"w-full bg-muted rounded-full h-1.5",children:(0,r.jsx)("div",{className:"bg-primary h-1.5 rounded-full transition-all duration-300 animate-pulse",style:{width:"70%"}})})]})]}),(0,r.jsx)(m.U,{isOpen:E.isOpen,onClose:()=>F(e=>({...e,isOpen:!1})),onConfirm:E.onConfirm,title:E.title,message:E.message,confirmText:"Delete",type:"danger"})]})]})}},5060:function(e,t,s){"use strict";s.d(t,{_:function(){return d}});var r=s(7437),a=s(2265),l=s(535),i=s(3448);let n=(0,l.j)("text-label-lg font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 text-foreground"),d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("label",{ref:t,className:(0,i.cn)(n(),s),...a})});d.displayName="Label"},3675:function(e,t,s){"use strict";s.d(t,{g:function(){return i}});var r=s(7437),a=s(2265),l=s(3448);let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-input-bg px-3 py-2 text-body-sm text-foreground ring-offset-background transition-all duration-200 placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:border-primary hover:border-ring disabled:cursor-not-allowed disabled:opacity-50 disabled:bg-muted resize-y",s),ref:t,...a})});i.displayName="Textarea"}}]);