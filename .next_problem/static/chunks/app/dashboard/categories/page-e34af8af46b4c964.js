(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2823],{1110:function(e,s,t){Promise.resolve().then(t.bind(t,4577))},4577:function(e,s,t){"use strict";t.d(s,{CategoriesPageClient:function(){return B}});var r=t(7437),a=t(2265),n=t(9820),i=t(4924),o=t(8842),d=t(9397),l=t(9174),c=t(1905),m=t(4794),u=t(8933),x=t(9376),f=t(2381),h=t(4357),p=t(6266),g=t(4630),y=t(8930),j=t(3793),v=t(3448);let b=j.fC,N=j.xz;j.ZA,j.Uv,j.Tr,j.Ee,a.forwardRef((e,s)=>{let{className:t,inset:a,children:n,...i}=e;return(0,r.jsx)(j.fF,{ref:s,className:(0,v.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-body-sm outline-none focus:bg-accent data-[state=open]:bg-accent",a&&"pl-8",t),...i,children:n})}).displayName=j.fF.displayName,a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(j.tu,{ref:s,className:(0,v.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-modern-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a})}).displayName=j.tu.displayName;let w=a.forwardRef((e,s)=>{let{className:t,sideOffset:a=4,...n}=e;return(0,r.jsx)(j.Uv,{children:(0,r.jsx)(j.VY,{ref:s,sideOffset:a,className:(0,v.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-modern-lg transition-all duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})})});w.displayName=j.VY.displayName;let C=a.forwardRef((e,s)=>{let{className:t,inset:a,...n}=e;return(0,r.jsx)(j.ck,{ref:s,className:(0,v.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-body-sm outline-none transition-colors duration-200 focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",t),...n})});C.displayName=j.ck.displayName,a.forwardRef((e,s)=>{let{className:t,children:a,checked:n,...i}=e;return(0,r.jsxs)(j.oC,{ref:s,className:(0,v.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-body-sm outline-none transition-colors duration-200 focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...i,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(j.wU,{children:(0,r.jsx)("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,r.jsx)("polyline",{points:"20,6 9,17 4,12"})})})}),a]})}).displayName=j.oC.displayName,a.forwardRef((e,s)=>{let{className:t,children:a,...n}=e;return(0,r.jsxs)(j.Rk,{ref:s,className:(0,v.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-body-sm outline-none transition-colors duration-200 focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(j.wU,{children:(0,r.jsx)("svg",{className:"h-2 w-2 fill-current",viewBox:"0 0 8 8",children:(0,r.jsx)("circle",{cx:"4",cy:"4",r:"2"})})})}),a]})}).displayName=j.Rk.displayName,a.forwardRef((e,s)=>{let{className:t,inset:a,...n}=e;return(0,r.jsx)(j.__,{ref:s,className:(0,v.cn)("px-2 py-1.5 text-label-md font-semibold text-muted-foreground",a&&"pl-8",t),...n})}).displayName=j.__.displayName;let _=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(j.Z0,{ref:s,className:(0,v.cn)("-mx-1 my-1 h-px bg-muted",t),...a})});_.displayName=j.Z0.displayName;var k=t(9064);function Z(e){let{categoryId:s,categoryName:t,productCount:n,onEdit:i}=e,o=(0,x.useRouter)(),[d,l]=(0,a.useState)(!1),[c,m]=(0,a.useState)({isOpen:!1,title:"",message:"",onConfirm:()=>{}});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(b,{children:[(0,r.jsx)(N,{asChild:!0,children:(0,r.jsxs)(f.z,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-muted/80",children:[(0,r.jsx)(p.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Open menu"})]})}),(0,r.jsxs)(w,{align:"end",className:"w-48",children:[(0,r.jsxs)(C,{onClick:i,className:"cursor-pointer",children:[(0,r.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Edit Category"]}),(0,r.jsx)(_,{}),(0,r.jsxs)(C,{onClick:()=>{if(!d){if(n>0){k.ZP.error('Cannot delete "'.concat(t,'" because it contains ').concat(n," product(s). Please move or delete the products first."));return}m({isOpen:!0,title:"Delete Category",message:'Are you sure you want to delete the category "'.concat(t,'"? This action cannot be undone.'),onConfirm:async()=>{m(e=>({...e,isOpen:!1})),l(!0);try{let e=(0,u.e)(),{error:t}=await e.from("categories").delete().eq("id",s);if(t)throw t;k.ZP.success("Category deleted successfully"),o.refresh()}catch(e){console.error("Error deleting category:",e),k.ZP.error("Error deleting category. Please try again.")}finally{l(!1)}}})}},disabled:n>0||d,className:"cursor-pointer ".concat(n>0||d?"opacity-50 cursor-not-allowed":"text-destructive focus:text-destructive hover:bg-destructive/10"),children:[(0,r.jsx)(y.Z,{className:"h-4 w-4 mr-2"}),n>0?"Cannot delete (".concat(n," products)"):"Delete Category"]})]})]}),(0,r.jsx)(h.U,{isOpen:c.isOpen,onClose:()=>m(e=>({...e,isOpen:!1})),onConfirm:c.onConfirm,title:c.title,message:c.message,confirmText:"Delete Category",type:"danger",isLoading:d})]})}var E=t(2489),z=t(279),R=t(3675),S=t(5060),O=t(5291),D=t(3229);function F(e){var s;let{vendorId:t,category:n,isEditing:i=!1,onSuccess:o}=e,l=(0,x.useRouter)(),[c,m]=(0,a.useState)(!1),[h,p]=(0,a.useState)({name:(null==n?void 0:n.name)||"",description:(null==n?void 0:n.description)||"",is_active:null===(s=null==n?void 0:n.is_active)||void 0===s||s}),g=async e=>{e.preventDefault(),m(!0);try{let e=(0,u.e)(),s={vendor_id:t,name:h.name,description:h.description||null,is_active:h.is_active,display_order:0};if(i&&n){let{error:t}=await e.from("categories").update(s).eq("id",n.id);if(t)throw t}else{let{error:t}=await e.from("categories").insert(s);if(t)throw t}i||p({name:"",description:"",is_active:!0}),k.ZP.success(i?"Category updated successfully!":"Category created successfully!"),null==o||o(),l.refresh()}catch(e){console.error("Error saving category:",e),k.ZP.error("Error saving category. Please try again.")}finally{m(!1)}};return(0,r.jsxs)("form",{onSubmit:g,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S._,{htmlFor:"category-name",className:"text-label-lg font-medium text-foreground",children:"Category Name *"}),(0,r.jsx)(z.I,{id:"category-name",value:h.name,onChange:e=>p(s=>({...s,name:e.target.value})),placeholder:"e.g., Electronics, Clothing, Home & Garden",required:!0,maxLength:255,className:"h-11"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S._,{htmlFor:"category-description",className:"text-label-lg font-medium text-foreground",children:"Description"}),(0,r.jsx)(R.g,{id:"category-description",value:h.description,onChange:e=>p(s=>({...s,description:e.target.value})),placeholder:"Optional description to help customers understand this category",rows:3,maxLength:500,className:"resize-none"}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("p",{className:"text-label-sm text-muted-foreground",children:"Help customers understand this category"}),(0,r.jsxs)("span",{className:"text-label-sm text-muted-foreground",children:[h.description.length,"/500"]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S._,{htmlFor:"category-status",className:"text-label-lg font-medium text-foreground",children:"Visibility Status"}),(0,r.jsxs)(O.Ph,{value:h.is_active?"active":"inactive",onValueChange:e=>p(s=>({...s,is_active:"active"===e})),children:[(0,r.jsx)(O.i4,{className:"h-11",children:(0,r.jsx)(O.ki,{placeholder:"Select visibility"})}),(0,r.jsxs)(O.Bw,{children:[(0,r.jsx)(O.Ql,{value:"active",children:"Active (Visible to customers)"}),(0,r.jsx)(O.Ql,{value:"inactive",children:"Inactive (Hidden from customers)"})]})]}),(0,r.jsx)("p",{className:"text-label-sm text-muted-foreground",children:"Controls whether customers can see this category"})]}),(0,r.jsx)(f.z,{type:"submit",disabled:c||!h.name.trim(),variant:"gradient",size:"lg",className:"w-full",children:c?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),i?"Updating...":"Creating..."]}):(0,r.jsx)(r.Fragment,{children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(D.Z,{className:"h-4 w-4 mr-2"}),"Update Category"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"Add Category"]})})}),(0,r.jsx)("div",{className:"bg-muted/30 rounded-lg p-3 text-center",children:(0,r.jsx)("p",{className:"text-label-sm text-muted-foreground",children:"\uD83D\uDCA1 Categories help organize your products and improve customer browsing experience"})})]})}function P(e){let{isOpen:s,onClose:t,category:i,vendorId:o}=e;return((0,a.useEffect)(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[s]),s)?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)(n.Zb,{className:"border-0 shadow-none",children:[(0,r.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between",children:[(0,r.jsx)(n.ll,{children:"Edit Category"}),(0,r.jsx)(f.z,{variant:"ghost",size:"sm",onClick:t,children:(0,r.jsx)(E.Z,{className:"h-4 w-4"})})]}),(0,r.jsx)(n.aY,{children:(0,r.jsx)(F,{vendorId:o,category:i,isEditing:!0,onSuccess:()=>{t()}})})]})})}):null}var I=t(2038),L=t(7340),T=t(795),A=t(3662),U=t(9892);function V(e){let{vendorId:s}=e,[t,n]=(0,a.useState)([]),[i,o]=(0,a.useState)(!0),[d,l]=(0,a.useState)(null),[c,m]=(0,a.useState)(null),[x,f]=(0,a.useState)(!1),[h,p]=(0,a.useState)(!1),g=(0,T.Dy)((0,T.VT)(T.we),(0,T.VT)(T.Lg,{coordinateGetter:A.is})),y=async()=>{try{let e=(0,u.e)(),{data:t,error:r}=await e.from("categories").select("\n          *,\n          products(count)\n        ").eq("vendor_id",s).order("display_order",{ascending:!0});if(r)throw r;n(t||[])}catch(e){l(e.message)}finally{o(!1)}};(0,a.useEffect)(()=>{y()},[s]);let j=e=>{m(e),f(!0)},v=async e=>{let{active:s,over:r}=e;if(s.id!==(null==r?void 0:r.id)){p(!0);let e=t.findIndex(e=>e.id===s.id),a=t.findIndex(e=>e.id===(null==r?void 0:r.id)),i=(0,A.Rp)(t,e,a);n(i);try{let e=(0,u.e)();for(let s of i.map((e,s)=>({id:e.id,display_order:s+1}))){let{error:t}=await e.from("categories").update({display_order:s.display_order}).eq("id",s.id);if(t)throw t}k.ZP.success("Categories reordered successfully")}catch(e){console.error("Error reordering categories:",e),k.ZP.error("Failed to reorder categories"),y()}finally{p(!1)}}};return i?(0,r.jsx)(I.bB,{}):d?(0,r.jsx)(L.Te,{title:"Failed to load categories",description:"We encountered an error while loading your categories: ".concat(d),onRetry:y}):t&&0!==t.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"space-y-3",children:[h&&(0,r.jsx)("div",{className:"bg-info/10 border border-info/20 rounded-lg p-3 text-center",children:(0,r.jsx)("p",{className:"text-body-sm text-info font-medium",children:"Reordering categories..."})}),(0,r.jsx)("div",{className:"space-y-3 transition-opacity duration-200 ".concat(h?"opacity-50":""),children:(0,r.jsx)(T.LB,{sensors:g,collisionDetection:T.pE,onDragEnd:v,children:(0,r.jsx)(A.Fo,{items:t.map(e=>e.id),strategy:A.qw,children:t.map(e=>(0,r.jsx)(q,{category:e,vendorId:s,onEdit:()=>j(e)},e.id))})})})]}),(0,r.jsx)(P,{isOpen:x,onClose:()=>{f(!1),m(null),y()},category:c,vendorId:s})]}):(0,r.jsx)(L.rn,{})}function q(e){var s,t;let{category:a,vendorId:n,onEdit:o}=e,{attributes:d,listeners:u,setNodeRef:x,transform:f,transition:h,isDragging:p}=(0,A.nB)({id:a.id}),g={transform:U.ux.Transform.toString(f),transition:h},y=(null===(t=a.products)||void 0===t?void 0:null===(s=t[0])||void 0===s?void 0:s.count)||0;return(0,r.jsx)("div",{ref:x,style:g,className:"group border-0 bg-card/80 backdrop-blur rounded-xl hover:shadow-modern-md transition-all duration-200 ".concat(p?"opacity-90 shadow-modern-lg z-50 scale-105 bg-card":"hover:bg-card"),children:(0,r.jsxs)("div",{className:"flex flex-col space-y-3 p-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 flex-1",children:[(0,r.jsx)("div",{...d,...u,className:"cursor-grab active:cursor-grabbing text-muted-foreground hover:text-foreground touch-none transition-colors opacity-0 group-hover:opacity-100 hidden sm:block",children:(0,r.jsx)(c.Z,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 sm:h-12 sm:w-12 items-center justify-center rounded-xl bg-chart-3/10 text-chart-3 flex-shrink-0",children:(0,r.jsx)(i.Z,{className:"h-5 w-5 sm:h-6 sm:w-6"})}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsx)("h3",{className:"text-base sm:text-heading-sm font-semibold text-foreground truncate",children:a.name}),a.description&&(0,r.jsx)("p",{className:"text-sm sm:text-body-sm text-muted-foreground truncate mt-1",children:a.description})]})]}),(0,r.jsx)("div",{className:"sm:hidden",children:(0,r.jsx)(Z,{categoryId:a.id,categoryName:a.name,productCount:y,onEdit:o})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between sm:flex-shrink-0 sm:space-x-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-sm sm:text-body-sm text-muted-foreground bg-muted/50 px-2 py-1 sm:px-3 sm:py-1.5 rounded-lg",children:[(0,r.jsx)(m.Z,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(0,r.jsx)("span",{className:"font-medium",children:y}),(0,r.jsx)("span",{className:"hidden sm:inline",children:1===y?"product":"products"})]}),(0,r.jsx)(l.C,{variant:a.is_active?"success":"secondary",className:"text-xs",children:a.is_active?"Active":"Inactive"})]}),(0,r.jsx)("div",{...d,...u,className:"cursor-grab active:cursor-grabbing text-muted-foreground hover:text-foreground touch-none transition-colors opacity-60 sm:hidden",children:(0,r.jsx)(c.Z,{className:"h-5 w-5"})}),(0,r.jsx)("div",{className:"hidden sm:block",children:(0,r.jsx)(Z,{categoryId:a.id,categoryName:a.name,productCount:y,onEdit:o})})]})]})})}function B(e){let{vendorId:s}=e,[t,l]=(0,a.useState)(0);return(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsxs)(n.Zb,{className:"border-0 bg-card/80 backdrop-blur",children:[(0,r.jsx)(n.Ol,{className:"pb-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-chart-3/10 text-chart-3",children:(0,r.jsx)(i.Z,{className:"h-6 w-6"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(n.ll,{className:"text-heading-lg font-semibold text-foreground",children:"Your Categories"}),(0,r.jsx)("p",{className:"text-body-sm text-muted-foreground",children:"Drag and drop to reorder"})]})]}),(0,r.jsx)("div",{className:"flex items-center space-x-2",children:(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-label-sm text-muted-foreground bg-muted/50 px-3 py-1.5 rounded-lg",children:[(0,r.jsx)(o.Z,{className:"h-3 w-3"}),(0,r.jsx)("span",{children:"Drag to reorder"})]})})]})}),(0,r.jsx)(n.aY,{className:"pt-0",children:(0,r.jsx)(V,{vendorId:s},t)})]})}),(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsxs)(n.Zb,{className:"border-0 bg-gradient-to-br from-primary/5 to-chart-1/5",children:[(0,r.jsx)(n.Ol,{className:"pb-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10 text-primary",children:(0,r.jsx)(d.Z,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(n.ll,{className:"text-heading-md font-semibold text-foreground",children:"Quick Add Category"}),(0,r.jsx)("p",{className:"text-body-sm text-muted-foreground",children:"Create a new category"})]})]})}),(0,r.jsx)(n.aY,{className:"pt-0",children:(0,r.jsx)(F,{vendorId:s,onSuccess:()=>{l(e=>e+1)}})})]})})]})}},5060:function(e,s,t){"use strict";t.d(s,{_:function(){return d}});var r=t(7437),a=t(2265),n=t(535),i=t(3448);let o=(0,n.j)("text-label-lg font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 text-foreground"),d=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("label",{ref:s,className:(0,i.cn)(o(),t),...a})});d.displayName="Label"},3675:function(e,s,t){"use strict";t.d(s,{g:function(){return i}});var r=t(7437),a=t(2265),n=t(3448);let i=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-input-bg px-3 py-2 text-body-sm text-foreground ring-offset-background transition-all duration-200 placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:border-primary hover:border-ring disabled:cursor-not-allowed disabled:opacity-50 disabled:bg-muted resize-y",t),ref:s,...a})});i.displayName="Textarea"}},function(e){e.O(0,[2972,7583,1643,9064,6498,6913,6113,3907,2971,2117,1744],function(){return e(e.s=1110)}),_N_E=e.O()}]);